<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>/Users/mbp02/Documents/TOPAZ/Implementation/Prototypes/MasterRindApp/app/lib/TOPAZ/masterrind/impl/MasterRindFacade.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/JSDriverDemo.Calc.html">JSDriverDemo.Calc</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.Auction.html">TOPAZ.masterrind.datatypes.Auction</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.BlackColored.html">TOPAZ.masterrind.datatypes.BlackColored</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.Company.html">TOPAZ.masterrind.datatypes.Company</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.Contact.html">TOPAZ.masterrind.datatypes.Contact</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.Course.html">TOPAZ.masterrind.datatypes.Course</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.CowFavorite.html">TOPAZ.masterrind.datatypes.CowFavorite</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.DaughterTested.html">TOPAZ.masterrind.datatypes.DaughterTested</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.Exhibition.html">TOPAZ.masterrind.datatypes.Exhibition</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.Genomics.html">TOPAZ.masterrind.datatypes.Genomics</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.Holsteins.html">TOPAZ.masterrind.datatypes.Holsteins</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.Hornless.html">TOPAZ.masterrind.datatypes.Hornless</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.MeetCattle.html">TOPAZ.masterrind.datatypes.MeetCattle</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.Meeting.html">TOPAZ.masterrind.datatypes.Meeting</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.RedColored.html">TOPAZ.masterrind.datatypes.RedColored</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.datatypes.YoungBreeder.html">TOPAZ.masterrind.datatypes.YoungBreeder</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.impl.AppointmentFactory.html">TOPAZ.masterrind.impl.AppointmentFactory</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.impl.CowFactory.html">TOPAZ.masterrind.impl.CowFactory</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.impl.FavoriteFactory.html">TOPAZ.masterrind.impl.FavoriteFactory</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.impl.MasterRindFacade.html">TOPAZ.masterrind.impl.MasterRindFacade</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.interfaces.Appointment.html">TOPAZ.masterrind.interfaces.Appointment</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.interfaces.Cow.html">TOPAZ.masterrind.interfaces.Cow</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.interfaces.Favorite.html">TOPAZ.masterrind.interfaces.Favorite</a></li>
            
                <li><a href="../classes/TOPAZ.masterrind.interfaces.MasterRindFactory.html">TOPAZ.masterrind.interfaces.MasterRindFactory</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: /Users/mbp02/Documents/TOPAZ/Implementation/Prototypes/MasterRindApp/app/lib/TOPAZ/masterrind/impl/MasterRindFacade.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
TOPAZ.namespace(&#x27;TOPAZ.masterrind.impl.MasterRindFacade&#x27;);

require(&#x27;TOPAZ/masterrind/impl/CowFactory&#x27;);
require(&#x27;TOPAZ/masterrind/impl/FavoriteFactory&#x27;);
require(&#x27;TOPAZ/masterrind/impl/AppointmentFactory&#x27;);
require(&#x27;TOPAZ/masterrind/interfaces/MasterRindFactory&#x27;);
require(&#x27;TOPAZ/masterrind/interfaces/Cow&#x27;);
require(&#x27;TOPAZ/masterrind/datatypes/Company&#x27;);
require(&#x27;TOPAZ/masterrind/datatypes/Contact&#x27;);
require(&#x27;TOPAZ/masterrind/interfaces/Appointment&#x27;);
require(&#x27;TOPAZ/masterrind/interfaces/Favorite&#x27;);

/**
 * Stellt Methoden für die Kontrollerklasse bereit. Kann als eine
 * Schnittstelle angesehen werden.
 *
 * @namespace TOPAZ.masterrind.impl
 * @class MasterRindFacade
 */
TOPAZ.masterrind.impl.MasterRindFacade = function(factory) {
	var factory = factory;
	var m_appointments = new Array();
	var m_companies = new Array();
	var m_contacts = new Array();
	var m_cows = new Array();
	var m_favorites = new Array();
	var db = Ti.Database.install(&#x27;/masterrind.sqlite&#x27;, &#x27;massterrindDB&#x27;);

	/**
	 * Holt Termindaten aus der Datenbank.
	 *
	 * @method loadAppointmentsFromDB
	 */
	this.loadAppointmentsFromDB = function() {

		var masterRindRS = db.execute(&#x27;SELECT date,id, name FROM appointments&#x27;);
		var appointment = new TOPAZ.masterrind.interfaces.Appointment();

		while (masterRindRS.isValidRow()) {

			appointment.setDate(masterRindRS.fieldByName(&#x27;date&#x27;));
			appointment.setId(masterRindRS.fieldByName(&#x27;id&#x27;));
			appointment.setName(masterRindRS.fieldByName(&#x27;name&#x27;));

			m_appointments.push(appointment);

			masterRindRS.next();
		}

		masterRindRS.close();
	};

	/**
	 * Holt Firmendaten aus der Datenbank.
	 *
	 * @method loadCompaniesFromDB
	 */
	this.loadCompaniesFromDB = function() {

		var masterRindRS = db.execute(&#x27;SELECT id,description, name, imprint FROM companies&#x27;);
		var company = new TOPAZ.masterrind.datatypes.Company();

		while (masterRindRS.isValidRow()) {

			company.setDescription(masterRindRS.fieldByName(&#x27;description&#x27;));
			company.setId(masterRindRS.fieldByName(&#x27;id&#x27;));
			company.setImprint(masterRindRS.fieldByName(&#x27;imprint&#x27;));
			company.setName(masterRindRS.fieldByName(&#x27;name&#x27;));

			m_companies.push(company);

			masterRindRS.next();
		}

		masterRindRS.close();
	};

	/**
	 * Holt Kontaktdaten aus der Datenbank.
	 *
	 * @method loadContactsFromDB
	 */
	this.loadContactsFromDB = function() {

		var masterRindRS = db.execute(&#x27;SELECT country,id, name, number,street, town, zipCode FROM contacts&#x27;);
		var contact = new TOPAZ.masterrind.datatypes.Contact();

		while (masterRindRS.isValidRow()) {

			contact.setCountry(masterRindRS.fieldByName(&#x27;country&#x27;));
			contact.setId(masterRindRS.fieldByName(&#x27;id&#x27;));
			contact.setName(masterRindRS.fieldByName(&#x27;name&#x27;));
			contact.setNumber(masterRindRS.fieldByName(&#x27;number&#x27;));
			contact.setStreet(masterRindRS.fieldByName(&#x27;street&#x27;));
			contact.setTown(masterRindRS.fieldByName(&#x27;town&#x27;));
			contact.setImprint(masterRindRS.fieldByName(&#x27;zipCode&#x27;));

			m_contacts.push(contact);

			masterRindRS.next();
		}

		masterRindRS.close();
	};

	/**
	 * Holt Kuhdaten aus der Datenbank.
	 *
	 * @method loadCowsFromDB
	 */
	this.loadCowsFromDB = function() {

		//RS=ResultSet
		var masterRindRS = db.execute(&#x27;SELECT id,image,name,father FROM cows&#x27;);

		while (masterRindRS.isValidRow()) {
			var cow = new TOPAZ.masterrind.interfaces.Cow();
			
			cow.setId(masterRindRS.fieldByName(&#x27;id&#x27;));
			cow.setImage(masterRindRS.fieldByName(&#x27;image&#x27;));
			cow.setName(masterRindRS.fieldByName(&#x27;name&#x27;));
			cow.setFather(masterRindRS.fieldByName(&#x27;father&#x27;));

			/**
			 * Fehler: Es wird immer die gleiche Kuh eingefügt (mit id=4).
			 * Ursache: cow wurde außerhalb der Schleife erstellt, deshalb
			 * 			wurde das gleiche Cowobjekt in Array geschrieben und
			 * 			dabei auch überschrieben.
			 * Lösung: Cow innerhalb der Schleife erstellen.
			 */
			m_cows.push(cow);
			masterRindRS.next();
		}

		masterRindRS.close();
	};

	/**
	 * Holt Favoritendaten aus der Datenbank.
	 *
	 * @method loadCompaniesFromDB
	 */
	this.loadFavoritesFromDB = function() {

		var masterRindRS = db.execute(&#x27;SELECT cowId, cowName, id, name FROM favorites&#x27;);
		var favorite = new TOPAZ.masterrind.interfaces.Favorite();

		while (masterRindRS.isValidRow()) {

			favorite.setCowId(masterRindRS.fieldByName(&#x27;cowId&#x27;));
			favorite.setCowName(masterRindRS.fieldByName(&#x27;cowName&#x27;));
			favorite.setId(masterRindRS.fieldByName(&#x27;id&#x27;));
			favorite.setName(masterRindRS.fieldByName(&#x27;name&#x27;));

			m_favorites.push(favorite);

			masterRindRS.next();
		}

		masterRindRS.close();
	};

	/**
	 * Erstellt eine Liste mit Terminobjekten.
	 *
	 * @method getAppointments
	 * @param {String} type
	 * @return {Array} appointments
	 */
	this.getAppointments = function(type) {

		var appointments = new Array();

		for ( i = 0; i &lt; m_appointments.length; i++) {

			appointment = factory.create(type);
			appointment.setDate(m_appointments[i].getDate());
			appointment.setId(m_appointments[i].getId());
			appointment.setName(m_appointments[i].getName());

			appointments.push(appointment);
		}

		return appointments;
	};

	/**
	 * Erstellt eine Liste mit Firmenobjekten.
	 *
	 * @method getCompanies
	 * @param {String} type
	 * @return {Array} companies
	 */
	this.getCompanies = function(type) {

		var companies = new Array();

		for ( i = 0; i &lt; m_companies.length; i++) {

			company = factory.create(type);
			company.setId(m_companies[i].getId());
			company.setDescription(m_companies[i].getDescription());
			company.setName(m_companies[i].getName());
			company.setImprint(m_companies[i].getImprint());

			cows.push(company);
		}

		return companies;
	};

	/**
	 * Erstellt eine Liste mit Kontaktobjekten.
	 *
	 * @method getContacts
	 * @param {String} type
	 * @return {Array} contacts
	 */
	this.getContacts = function(type) {

		var contacts = new Array();

		for ( i = 0; i &lt; m_contacts.length; i++) {

			contact = factory.create(type);
			contact.setCountry(m_contacts[i].getCountry());
			contact.setId(m_contacts[i].getId());
			contact.setName(m_contacts[i].getName());
			contact.setNumber(m_contacts[i].getNumber());
			contact.setStreet(m_contacts[i].getStreet());
			contact.setTown(m_contacts[i].getTown());
			contact.setZipCode(m_contacts[i].getZipCode());

			cows.push(contact);
		}

		return contacts;
	};

	/**
	 * Erstellt eine Liste mit Kuhobjekten.
	 *
	 * @method getCows
	 * @param {String} type
	 * @return {Array} cows
	 */
	
	this.getCows = function(type) {
		cs = new Array();
		//TODO: factory in allen Methoden anpassen.
		//TODO: debugging, factories testen, 
		//gleicher fehler wie bei load fromDB?????????
		var factory=new TOPAZ.masterrind.impl.CowFactory();
		
		for ( i = 0; i &lt; m_cows.length; i++) {
			
			/**
			 * Fehler:verschiedene Objekte mit gleichen Eigenschften
			 * 			im Array.
			 * Ursache: wahrscheinlich liegt die Ursache in abgeleiteten Objekten.
			 * Lösung: javascript Vererbung nachschlagen.
			 */
			var cow = new TOPAZ.masterrind.interfaces.Cow();
			//factory.create(type);
			cow.setId(m_cows[i].getId());
			cow.setImage(m_cows[i].getImage());
			cow.setName(m_cows[i].getName());
			cow.setFather(m_cows[i].getFather());
console.log(&quot;getCow &quot;+cow.getId());
			cs.push(cow);
		
		console.log(&quot;liste-&gt; &quot;+cs[i].getId());	
		}
		
		for(i=0;i&lt;cs.length;i++){
			// if(i&gt;1)console.log(&quot;liste-&gt; &quot;+i+&quot; &quot;+Object.is(cs[i],cs[i-1]));
			// console.log(&quot;cs-obejct-&gt; &quot;+cs[i]);
			console.log(&quot;cs-&gt; &quot;+i+&quot; &quot;+cs[i].getId()+&quot; &quot;+cs[i].getName());
		}

		return cs;
	};

	/**
	 * Erstellt eine Liste mit Favoritobjekten.
	 *
	 * @method getFavorites
	 * @param {String} type
	 * @return {Array} favorites
	 */
	this.getFavorites = function(type) {

		var favorites = new Array();

		for ( i = 0; i &lt; m_favorites.length; i++) {

			favorite = factory.create(type);
			favorite.setCowId(m_favorites[i].getCowId());
			favorite.setCowName(m_favorites[i].getCowName());
			favorite.setId(m_favorites[i].getId());
			favorite.setName(m_favorites[i].getName());

			favorites.push(favorite);
		}

		return favorites;

	};

	//Später Kuhobjekt übergeben
	/**
	 * Schreibt einen Favoriten in die Datenbank.
	 *
	 * @method addFavorite
	 * @param {String} cowId {String} cowName {String} id {String} name
	 * @return {bool} true bei Erfolg
	 */
	this.addFavorite = function(cowId, cowName, id, name) {

		// favorite = factory.create(type);
		// favorite.setName(name);
		// favorite.setCowId(id);
		// favorite.setCowName(cowName);
		// favorite.setCowId(cowId);

		//db.execute(&#x27;BEGIN&#x27;);
		db.execute(&#x27;INSERT INTO favorites (cowId,cowName,id,name) VALUES (?,?,?,?)&#x27;, cowId, cowName, id, name);
		//db.execute(&#x27;COMMIT&#x27;);
		db.close();

		// return favorite;
	};
	/**
	 * Löscht einen Favoriten aus der Datenbank.
	 *
	 * @method removeFavorite
	 * @param {String} id
	 * @return {bool} true bei Erfolg
	 */
	this.removeFavorite = function(id) {

	};
};

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
